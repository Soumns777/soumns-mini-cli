<script>
export default {
  onLaunch: function() {
    if (wx.canIUse('getUpdateManager')) {
      const updateManager = wx.getUpdateManager()
      updateManager.onCheckForUpdate(function(res) {

        console.log('ğŸ’™ğŸ’›å°ç¨‹åºç‰ˆæœ¬æ˜¯å¦æ˜¯æœ€æ–°çš„ç‰ˆæœ¬', res.hasUpdate)
        // è¯·æ±‚å®Œæ–°ç‰ˆæœ¬ä¿¡æ¯çš„å›è°ƒ
        if (res.hasUpdate) {
          updateManager.onUpdateReady(function() {
            wx.showModal({
              title: 'æ›´æ–°æç¤º',
              content: 'æ–°ç‰ˆæœ¬å·²ç»å‡†å¤‡å¥½ï¼Œæ˜¯å¦é‡å¯åº”ç”¨ï¼Ÿ',
              success: function(res) {
                if (res.confirm) {
                  // æ–°çš„ç‰ˆæœ¬å·²ç»ä¸‹è½½å¥½ï¼Œè°ƒç”¨ applyUpdate åº”ç”¨æ–°ç‰ˆæœ¬å¹¶é‡å¯
                  updateManager.applyUpdate()
                }
              }
            })
          })
          updateManager.onUpdateFailed(function() {
            // æ–°çš„ç‰ˆæœ¬ä¸‹è½½å¤±è´¥
            wx.showModal({
              title: 'å·²ç»æœ‰æ–°ç‰ˆæœ¬äº†å“Ÿ~',
              content: 'æ–°ç‰ˆæœ¬å·²ç»ä¸Šçº¿å•¦~ï¼Œè¯·æ‚¨åˆ é™¤å½“å‰å°ç¨‹åºï¼Œé‡æ–°æœç´¢æ‰“å¼€å“Ÿ~'
            })
          })
        } else {
          wx.showModal({
            title: 'æ›´æ–°æç¤º',
            content: 'ä»£ç å·²ç»æ˜¯æœ€æ–°çš„äº†',
            success: function(res) {
              if (res.confirm) {
                // æ–°çš„ç‰ˆæœ¬å·²ç»ä¸‹è½½å¥½ï¼Œè°ƒç”¨ applyUpdate åº”ç”¨æ–°ç‰ˆæœ¬å¹¶é‡å¯
                updateManager.applyUpdate()
              }
            }
          })
        }
      })
    } else {
      // å¦‚æœå¸Œæœ›ç”¨æˆ·åœ¨æœ€æ–°ç‰ˆæœ¬çš„å®¢æˆ·ç«¯ä¸Šä½“éªŒæ‚¨çš„å°ç¨‹åºï¼Œå¯ä»¥è¿™æ ·å­æç¤º
      wx.showModal({
        title: 'æç¤º',
        content: 'å½“å‰å¾®ä¿¡ç‰ˆæœ¬è¿‡ä½ï¼Œæ— æ³•ä½¿ç”¨è¯¥åŠŸèƒ½ï¼Œè¯·å‡çº§åˆ°æœ€æ–°å¾®ä¿¡ç‰ˆæœ¬åé‡è¯•ã€‚'
      })
    }
  },
  onShow: function() {

  },
  onHide: function() {

  }
}
</script>

<style lang='scss'>
/* æ³¨æ„è¦å†™åœ¨ç¬¬ä¸€è¡Œï¼ŒåŒæ—¶ç»™styleæ ‡ç­¾åŠ å…¥lang="scss"å±æ€§ */
@import 'uview-ui/index.scss';

* {
  margin: 0;
  padding: 0;
}
</style>
